import{k as X,Z,J as z,a2 as B,X as H,a3 as V,r as W,K as m,j as s,a4 as S,a1 as U}from"./app-Do2TdiUf.js";const es=()=>{var b,j,N,p,v,f,w,y,k,_,C,q,M,I;const x=X(),h=Z(),G=localStorage.getItem("authToken"),{data:d}=z(),{data:a,isLoading:g,error:c}=B(void 0,{refetchOnMountOrArgChange:!0}),[L]=H(),[Y]=V();W.useEffect(()=>{var e;(c==null?void 0:c.status)===401?(localStorage.removeItem("authToken"),x("/signin")):c&&m.error(((e=c==null?void 0:c.data)==null?void 0:e.message)||"Failed to load cart")},[c,x]);const E=(e,r,t)=>{const l=Number(r)||0,n=Number(t)||0;if(l>=n){m.warn(`Only ${n} item(s) available in stock`);return}u(e,l+1)},J=(e,r)=>{const t=Number(r)||0;t<=1||u(e,t-1)},u=async(e,r)=>{var n;const t=Number(r);if(isNaN(t)||t<1)return;const l=h(U.util.updateQueryData("getCartSummery",void 0,i=>{const o=i.data.cart_items.find(Q=>Q.id===e);o&&(o.quantity=r)}));try{await Y({id:e,quantity:r}).unwrap()}catch(i){l.undo(),m.error(((n=i==null?void 0:i.data)==null?void 0:n.message)||"Update failed")}},K=async e=>{const r=h(U.util.updateQueryData("getCartSummery",void 0,t=>{t.data.cart_items=t.data.cart_items.filter(l=>l.id!==e)}));try{await L(e).unwrap()}catch{r.undo()}};return g?s.jsx("div",{className:"min-h-screen py-8 px-5 2xl:px-20 bg-dark1 animate-pulse",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsx("div",{className:"h-10 bg-dark2 rounded-lg w-64 mb-8"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[s.jsx("div",{className:"md:col-span-2",children:s.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray/30",children:s.jsx("div",{className:"h-7 bg-dark3 rounded w-48"})}),s.jsx("div",{className:"divide-y divide-gray/30",children:[1,2,3].map(e=>s.jsxs("div",{className:"p-6 flex flex-col sm:flex-row items-start sm:items-center gap-6",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"w-24 h-24 bg-dark3 rounded-lg"}),s.jsx("div",{className:"w-24 h-24 bg-dark3 rounded-lg hidden sm:block"})]}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsx("div",{className:"h-6 bg-dark3 rounded w-3/4"}),s.jsx("div",{className:"h-5 bg-dark3 rounded w-24"}),s.jsx("div",{className:"h-5 bg-dark3 rounded w-32"}),s.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"w-8 h-8 bg-dark3 rounded-l-md"}),s.jsx("div",{className:"w-12 h-8 bg-dark3"}),s.jsx("div",{className:"w-8 h-8 bg-dark3 rounded-r-md"})]}),s.jsx("div",{className:"w-8 h-8 bg-dark3 rounded"})]})]}),s.jsx("div",{className:"h-8 bg-dark3 rounded w-20"})]},e))})]})}),s.jsx("div",{className:"md:col-span-1",children:s.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md sticky top-8",children:[s.jsx("div",{className:"p-6 border-b border-gray/30",children:s.jsx("div",{className:"h-7 bg-dark3 rounded w-40"})}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("div",{className:"h-5 bg-dark3 rounded w-20"}),s.jsx("div",{className:"h-5 bg-dark3 rounded w-24"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("div",{className:"h-5 bg-dark3 rounded w-20"}),s.jsx("div",{className:"h-5 bg-dark3 rounded w-24"})]}),s.jsx("div",{className:"pt-4 border-t border-gray/30",children:s.jsxs("div",{className:"flex justify-between mb-4",children:[s.jsx("div",{className:"h-6 bg-dark3 rounded w-16"}),s.jsx("div",{className:"h-7 bg-dark3 rounded w-28"})]})}),s.jsx("div",{className:"h-12 bg-green-800/50 rounded-lg"})]})]})})]})]})}):s.jsx("div",{className:"min-h-screen py-8  bg-dark1",children:s.jsx("div",{className:"max-w-[1200px] mx-auto px-4 2xl:px-20",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsx("h1",{className:"text-xl md:text-3xl md:font-bold text-cream mb-8",children:"Your Shopping Cart"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[s.jsx("div",{className:"md:col-span-2",children:s.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray/30",children:s.jsxs("h2",{className:"text-xl font-semibold text-gray",children:["Cart Items (",((j=(b=a==null?void 0:a.data)==null?void 0:b.cart_items)==null?void 0:j.length)||0,")"]})}),s.jsx("div",{className:"divide-y divide-gray/30",children:((p=(N=a==null?void 0:a.data)==null?void 0:N.cart_items)==null?void 0:p.length)===0?s.jsx("div",{className:"p-6 text-center text-gray",children:"Your cart is empty"}):(f=(v=a==null?void 0:a.data)==null?void 0:v.cart_items)==null?void 0:f.map(e=>{var P,F,$,A,D,O;const r=T=>T&&T.trim()!=="",t=r((P=e.product)==null?void 0:P.thumb_image)?`/${e.product.thumb_image}`:null,l=r(e==null?void 0:e.front_image)?`/${e.front_image}`:null,n=r(e==null?void 0:e.back_image)?`/${e.back_image}`:null,i=t||l||n,o=((F=e.product)==null?void 0:F.qty)||0,R=(e.quantity||1)>=o;return console.log(e),s.jsxs("div",{className:"p-6 flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-6",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[t&&s.jsx("img",{src:t,alt:"",className:"w-24 h-24 object-cover rounded-lg"}),l&&s.jsx("img",{src:l,alt:"",className:"w-24 h-24 object-contain rounded-lg"}),n&&s.jsx("img",{src:n,alt:"",className:"w-24 h-24 object-cover rounded-lg"}),!i&&s.jsx("div",{className:"w-24 h-24 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-xs text-gray-500",children:"No Image"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-medium text-cream",children:($=e==null?void 0:e.product)==null?void 0:$.name}),s.jsxs("p",{className:"text-sm md:text-lg font-bold text-gray mt-1",children:[(A=d==null?void 0:d.settings)==null?void 0:A.currency_icon,Number(e.price)]}),s.jsxs("p",{className:"text-sm font-bold text-gray mt-1",children:["Extra Price",(D=d==null?void 0:d.settings)==null?void 0:D.currency_icon,Number(e.extra_price)]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[s.jsxs("div",{className:"flex",children:[s.jsx("button",{onClick:()=>J(e.id,e.quantity),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded-l-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.quantity<=1,children:"âˆ’"}),s.jsx("span",{className:"w-12 h-8 flex items-center justify-center bg-gray-100 font-medium",children:e.quantity}),s.jsx("button",{onClick:()=>E(e.id,e.quantity,o),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded-r-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:R,children:"+"})]}),R&&s.jsxs("p",{className:"text-yellow-500 text-xs",children:["Max available:"," ",o]}),s.jsx("button",{onClick:()=>K(e.id),className:"text-red-600 hover:text-red-700 cursor-pointer",children:s.jsx(S,{})})]})]}),s.jsx("div",{className:"mt-2 sm:mt-0",children:s.jsxs("p",{className:"text-lg font-bold text-cream",children:[(O=d==null?void 0:d.settings)==null?void 0:O.currency_icon,Number(e.price)*e.quantity]})})]},e.id)})})]})}),s.jsx("div",{className:"md:col-span-1",children:s.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md sticky top-8",children:[s.jsx("div",{className:"p-6 border-b border-gray/30",children:s.jsx("h2",{className:"text-xl font-semibold text-cream",children:"Order Summary"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{className:"text-cream",children:"Subtotal"}),s.jsxs("span",{className:"font-medium text-cream",children:[(w=d==null?void 0:d.settings)==null?void 0:w.currency_icon,((y=a==null?void 0:a.data)==null?void 0:y.sub_total)||0]})]}),s.jsxs("div",{className:"flex justify-between mb-4",children:[s.jsx("span",{className:"text-cream",children:"Discount"}),s.jsxs("span",{className:"font-medium text-green-600",children:["-",(k=d==null?void 0:d.settings)==null?void 0:k.currency_icon,Number(((_=a==null?void 0:a.data)==null?void 0:_.discount)||0)]})]}),s.jsxs("div",{className:"flex justify-between text-lg font-bold mb-6 pt-4 border-t border-gray/30",children:[s.jsx("span",{className:"text-cream",children:"Total"}),s.jsxs("span",{className:"text-cream",children:[(C=d==null?void 0:d.settings)==null?void 0:C.currency_icon,((q=a==null?void 0:a.data)==null?void 0:q.sub_total)||0]})]}),s.jsx("button",{onClick:()=>{if(G)x("/checkout");else{const e=window.location.pathname;x(`/signin?redirect=${encodeURIComponent(e)}`),m.warn("Please login to continue shopping!",{position:"top-center"})}},className:"w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 transition-colors",disabled:g||(((I=(M=a==null?void 0:a.data)==null?void 0:M.cart_items)==null?void 0:I.length)||0)===0,children:"Proceed to Checkout"})]})]})})]})]})})})};export{es as default};
