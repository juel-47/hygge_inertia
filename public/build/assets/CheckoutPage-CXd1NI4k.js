import{k as F,a5 as O,a2 as D,a6 as Q,a7 as Y,r as q,j as e}from"./app-Do2TdiUf.js";const H=()=>{var N,v,k,_,C,w,S,P,T;const A=F(),{data:r,isLoading:L}=O(),{data:i,isLoading:M}=D(),[I,{isLoading:x}]=Q(),[E,{isLoading:h}]=Y(),[s,u]=q.useState({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",country:"",paymentMethod:"cashOnDelivery",paypalEmail:"",shippingMethod:"",pickupLocationId:"",deliveryType:"shipping",termsAgreed:!1,bill_firstName:"",bill_lastName:"",bill_email:"",bill_phone:"",bill_address:"",bill_city:"",bill_state:"",bill_zipCode:"",bill_country:"",shipToDifferentAddress:!1});q.useEffect(()=>{var a;((a=r==null?void 0:r.shipping_methods)==null?void 0:a.length)>0&&s.deliveryType==="shipping"&&!s.shippingMethod&&u(l=>({...l,shippingMethod:r.shipping_methods[0].id.toString()}))},[r,s.deliveryType]);const t=a=>{const{name:l,value:c,type:o,checked:n}=a.target;if(l==="shipToDifferentAddress"){u(d=>({...d,shipToDifferentAddress:n,deliveryType:n?"shipping":d.deliveryType,pickupLocationId:n?"":d.pickupLocationId}));return}u(d=>({...d,[l]:o==="checkbox"?n:c}))},$=async a=>{var c,o,n;if(a.preventDefault(),s.deliveryType==="pickup"&&!s.pickupLocationId)return alert("Please select a pickup location");let l={personal_info:{name:`${s.firstName} ${s.lastName}`.trim(),email:s.email,phone:s.phone,address:s.address,city:s.city,state:s.state,zip:s.zipCode,country:s.country}};if(s.shipToDifferentAddress?l.shipping_address={name:`${s.bill_firstName} ${s.bill_lastName}`.trim(),email:s.bill_email,phone:s.bill_phone,address:s.bill_address,city:s.bill_city,state:s.bill_state,zip:s.bill_zipCode,country:s.bill_country}:l.shipping_address=l.personal_info,s.deliveryType==="shipping"){const d=(c=r==null?void 0:r.shipping_methods)==null?void 0:c.find(y=>y.id.toString()===s.shippingMethod);l.shipping_method=d||{id:0,cost:0}}else if(s.deliveryType==="pickup"){const d=(o=r==null?void 0:r.pickup_methods)==null?void 0:o.find(y=>y.id.toString()===s.pickupLocationId);l.shipping_method={...d}}try{if(s.paymentMethod==="cashOnDelivery")await I(l).unwrap(),A("/success");else if(s.paymentMethod==="paypal"){if(!s.paypalEmail)return alert("PayPal email required");const d=await E(l).unwrap();d.redirect_url&&(window.location.href=d.redirect_url)}}catch(d){console.log("Order Error:",d),alert(`Payment failed: ${((n=d==null?void 0:d.data)==null?void 0:n.message)||"Try again"}`)}};if(L||M)return e.jsx("div",{className:"min-h-screen bg-dark1 flex items-center justify-center",children:e.jsx("div",{className:"text-cream text-xl",children:"Loading..."})});const m=(N=i==null?void 0:i.data)==null?void 0:N.currency_icon,g=parseFloat((((v=i==null?void 0:i.data)==null?void 0:v.sub_total)||"0").toString().replace(/,/g,""))||0;console.log(g);let p=0;if(s.deliveryType==="shipping"){const a=(k=r==null?void 0:r.shipping_methods)==null?void 0:k.find(l=>l.id.toString()===s.shippingMethod);p=a&&parseFloat(a.cost)||0}const z=g+p,f=((C=(_=i==null?void 0:i.data)==null?void 0:_.cart_items)==null?void 0:C.map(a=>{const l=JSON.parse(a.options||"{}");return{id:a.id,name:a.product.name,price:parseFloat(a.price),quantity:a.quantity,image:l.image||a.product.thumb_image||"",front_image:a.front_image||"",back_image:a.back_image||""}}))||[],b=a=>a&&a.trim()!==""&&a!=="null"&&!a.includes("null"),j=s.shipToDifferentAddress;return e.jsx("div",{className:"min-h-screen bg-dark1 py-12",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-4   2xl:px-20",children:[e.jsx("h1",{className:"text-3xl font-bold text-cream mb-8",children:"Checkout"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"bg-dark2 rounded-lg shadow-md p-6",children:e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-cream mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",required:!0,value:s.firstName,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Enter your first name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:s.lastName,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Enter your last name"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",required:!0,value:s.email,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Your email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Your phone"})]})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Street Address *"}),e.jsx("input",{type:"text",name:"address",required:!0,value:s.address,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"House, road, area"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"City *"}),e.jsx("input",{type:"text",name:"city",required:!0,value:s.city,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"State *"}),e.jsx("input",{type:"text",name:"state",required:!0,value:s.state,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"ZIP Code *"}),e.jsx("input",{type:"text",name:"zipCode",required:!0,value:s.zipCode,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Country *"}),e.jsxs("select",{name:"country",required:!0,value:s.country,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream",children:[e.jsx("option",{value:"",children:"Select Country"}),(w=r==null?void 0:r.countries)==null?void 0:w.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray/30",children:e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"shipToDifferentAddress",checked:s.shipToDifferentAddress,onChange:t,className:"w-5 h-5 text-red focus:ring-red rounded"}),e.jsx("span",{className:"text-red font-bold text-lg",children:"Ship to a different address?"})]})})]}),s.shipToDifferentAddress&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-cream mb-4",children:"Shipping Address (Different)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"bill_firstName",required:!0,value:s.bill_firstName,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Enter shipping first name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Last Name"}),e.jsx("input",{type:"text",name:"bill_lastName",value:s.bill_lastName,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Enter shipping last name"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"bill_email",required:!0,value:s.bill_email,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Shipping email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"bill_phone",value:s.bill_phone,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"Shipping phone"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Street Address *"}),e.jsx("input",{type:"text",name:"bill_address",required:!0,value:s.bill_address,onChange:t,className:"w-full px-3 py-2 border border-gray/30 focus:border-gray rounded-md bg-dark1 text-cream",placeholder:"House, road, area"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"City *"}),e.jsx("input",{type:"text",name:"bill_city",required:!0,value:s.bill_city,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"State *"}),e.jsx("input",{type:"text",name:"bill_state",required:!0,value:s.bill_state,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"ZIP Code *"}),e.jsx("input",{type:"text",name:"bill_zipCode",required:!0,value:s.bill_zipCode,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-2",children:"Country *"}),e.jsxs("select",{name:"bill_country",required:!0,value:s.bill_country,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream",children:[e.jsx("option",{value:"",children:"Select Country"}),(S=r==null?void 0:r.countries)==null?void 0:S.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-cream mb-4",children:"Payment Method"}),e.jsx("div",{className:"space-y-3",children:["cashOnDelivery","paypal","payoneer","mobilePay"].map(a=>e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:a,checked:s.paymentMethod===a,onChange:t,className:"text-red focus:ring-red"}),e.jsx("span",{className:"text-gray capitalize",children:a.replace(/([A-Z])/g," $1").trim()})]},a))}),s.paymentMethod==="paypal"&&e.jsx("div",{className:"mt-4",children:e.jsx("input",{type:"email",name:"paypalEmail",required:!0,placeholder:"PayPal Email *",value:s.paypalEmail,onChange:t,className:"w-full px-3 py-2 border border-gray/30 rounded-md bg-dark1 text-cream"})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-cream mb-4",children:"Delivery Method"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"deliveryType",value:"shipping",checked:s.deliveryType==="shipping",onChange:t,className:"text-red focus:ring-red"}),e.jsx("span",{className:"text-cream font-medium",children:"Ship to My Address"})]}),!j&&e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"deliveryType",value:"pickup",checked:s.deliveryType==="pickup",onChange:t,className:"text-red focus:ring-red"}),e.jsx("span",{className:"text-red font-bold",children:"Pickup from Store (Free)"})]}),j&&e.jsx("p",{className:"text-sm text-gray italic ml-8",children:"Pickup not available for different billing address."})]}),s.deliveryType==="shipping"&&((P=r==null?void 0:r.shipping_methods)==null?void 0:P.length)>0&&e.jsxs("div",{className:"mt-6 p-5 bg-dark1/50 rounded-lg border border-gray/30",children:[e.jsx("h4",{className:"text-lg font-medium text-cream mb-4",children:"Choose Shipping Method"}),e.jsx("div",{className:"space-y-3",children:r.shipping_methods.map(a=>e.jsxs("label",{className:"flex items-center justify-between cursor-pointer p-3 rounded hover:bg-dark1/70 transition",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"radio",name:"shippingMethod",value:a.id.toString(),checked:s.shippingMethod===a.id.toString(),onChange:t,className:"text-red focus:ring-red"}),e.jsx("span",{className:"text-gray",children:a.name})]}),e.jsx("span",{className:"text-cream font-semibold",children:a.cost==0?"Free":`${m}${a.cost}`})]},a.id))})]}),s.deliveryType==="pickup"&&((T=r==null?void 0:r.pickup_methods)==null?void 0:T.length)>0&&e.jsxs("div",{className:"mt-6 p-5 bg-dark1/50 rounded-lg border border-red/40",children:[e.jsx("h4",{className:"text-lg font-semibold text-cream mb-4",children:"Select Pickup Location"}),e.jsx("div",{className:"space-y-4",children:r.pickup_methods.map(a=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer p-3 rounded hover:bg-dark1/70 transition",children:[e.jsx("input",{type:"radio",name:"pickupLocationId",value:a.id.toString(),checked:s.pickupLocationId===a.id.toString(),onChange:t,className:"mt-1 text-red focus:ring-red"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-cream font-medium",children:a.store_name}),e.jsxs("p",{className:"text-sm text-gray",children:["Address:"," ",a.address]}),e.jsxs("p",{className:"text-sm text-gray",children:["Phone:"," ",a.phone]})]})]},a.id))})]})]}),e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"termsAgreed",required:!0,checked:s.termsAgreed,onChange:t,className:"text-red focus:ring-red"}),e.jsx("span",{className:"text-sm text-cream",children:"I agree to the terms and conditions *"})]}),e.jsx("button",{type:"submit",disabled:x||h,className:`w-full bg-red text-white py-3 px-4 rounded-md transition font-medium ${x||h?"opacity-50 cursor-not-allowed":"hover:bg-red/90"}`,children:x||h?"Processing...":"Complete Order"})]})}),e.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md p-6 sticky top-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-cream mb-6 border-b border-gray/30 pb-3",children:"Order Summary"}),e.jsx("div",{className:"space-y-5",children:f.length>0?f.map(a=>{const l=b(a.image)?`/${a.image}`:null,c=b(a.front_image)?`/${a.front_image}`:null,o=b(a.back_image)?`/${a.back_image}`:null,n=a.price*a.quantity;return e.jsxs("div",{className:"flex gap-4 pb-5 border-b border-gray/20 last:border-0",children:[e.jsx("div",{className:"shrink-0",children:l?e.jsx("img",{src:l,alt:a.name,className:"w-20 h-20 object-cover rounded-lg border border-gray/40"}):e.jsx("div",{className:"w-20 h-20 bg-gray-200 border-2 border-dashed rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"No Image"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-cream text-sm line-clamp-2",children:a.name}),(c||o)&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[c&&e.jsx("img",{src:c,alt:"Front",className:"w-12 h-12 object-contain rounded border bg-white p-1"}),o&&e.jsx("img",{src:o,alt:"Back",className:"w-12 h-12 object-contain rounded border bg-white p-1"})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsxs("span",{className:"text-xs text-gray",children:["Qty: ",a.quantity]}),e.jsxs("span",{className:"text-sm font-bold text-cream",children:[m,n]})]})]})]},a.id)}):e.jsx("p",{className:"text-center text-gray py-8",children:"Your cart is empty"})}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray/40 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-cream",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:[m,g]})]}),e.jsxs("div",{className:"flex justify-between text-cream",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{className:p===0?"text-green-400":"",children:p===0?"Free":`${m}${p}`})]}),e.jsxs("div",{className:"pt-4 border-t border-gray/40 flex justify-between text-lg font-bold text-cream",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{className:"text-red",children:[m,z]})]})]}),s.deliveryType==="pickup"&&e.jsx("div",{className:"mt-4 p-3 bg-green-900/30 border border-green-500/50 rounded-lg text-center",children:e.jsx("p",{className:"text-sm text-green-300 font-medium",children:"Pickup Selected â€“ Free Shipping!"})})]})]})]})})};export{H as default};
